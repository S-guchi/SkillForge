
# Debianのパッケージコマンドについて

## 目次

- `apt`と`apt-get`ってどっち使えばいいの？
- Dockerfileのapt-getをワンライナーで書く理由

---
 

## `apt`と`apt-get`ってどっち使えばいいの？

---

### ふたつのコマンドの前提

#### `apt-get`

```bash
root@2cab2577bf26:/# apt-get -h
apt 2.4.13 (arm64)
使用法: apt-get [オプション] コマンド
        apt-get [オプション] install|remove パッケージ名1 [パッケージ名2 ...]
        apt-get [オプション] source パッケージ名1 [パッケージ名2 ...]

apt-get は、認証されたソースからのパッケージと情報の検索、
および依存関係を伴うパッケージのインストール、アップグレード、
削除のためのコマンドラインインターフェースです。
```

#### `apt`

```bash
root@2cab2577bf26:/# apt -h
apt 2.4.13 (arm64)
使用方法: apt [オプション] コマンド

apt は、検索や管理、パッケージに関する情報を問い合わせるコマンドを
提供するコマンドラインパッケージマネージャです。apt-get や apt-cache
のような特化した APT ツールと同じ機能を提供しますが、デフォルトで
対話的に使用するために適切なオプションを有効にします。
```

---

### 主なポイント

- **どちらもパッケージを管理するツール！**
    - 実行例:
        
        ```bash
        apt install curl  
        apt-get install curl
        ```
        
- **誕生日の違い**
    - `apt-get`: 1990年生まれのベテラン！
    - `apt`: 2014年生まれの若手で機能もリッチ！
- **`apt`の見栄えポイント**
    - プログレスバーが表示される！  
        → 見た目がかっこよく、進捗も分かりやすい。

---

### 結論

- **CLIでは`apt`が公式おすすめ！**
    - ユーザーライクな表示
    - プログレスバーが見えると気分が上がる！
- **でも、Dockerやスクリプトでは`apt-get`が鉄板！**
    - 互換性が高く、余計な表示がなくてスクリプト向け。
    - Docker公式でも「`apt-get`を使え」と明記されている。

---

## Dockerfileのapt-getをワンライナーで書く理由

---

### 理由その1: **キャッシュによる不具合を防ぐため！**

- `apt-get update`と`install`を分けて書くと…  
    → 更新結果だけキャッシュされて、最新のパッケージが取得できないことも！

---

### 理由その2: **イメージレイヤーを少なくしてサイズを減らす！**

- レイヤー数を減らすことで、最終的なイメージサイズを削減。
- パッケージ数が増えるとさらに効果が実感できる！

---

### ワンライナー例

```bash
RUN apt-get update && apt-get install -y \
    curl \
    vim \
    git \
 && apt-get clean \
 && rm -rf /var/lib/apt/lists/*
```

---

### 実験してみた！

#### 個別に記述:

```bash
RUN apt-get update
RUN apt-get install -y curl vim
RUN apt-get clean
```

#### ワンライナー:

```bash
RUN apt-get update && \
    apt-get install -y \
    curl \
    vim \
    && apt-get clean
```

→ **ちょ～～～～っと減った！**  
「パッケージ数が増えるほど、ワンライナーの恩恵が大きくなるかも！」

---

### VSCode用スニペット

VSCodeで簡単に`apt-get`構文を入力できるスニペットを用意しました！

```json
{
  "apt-get": {
    "prefix": "apt-get",
    "body": [
      "RUN apt-get update && apt-get install -y \\",
      "    ${1:package1} \\",
      "    ${2:package2} \\",
      "    ${3:package3} \\",
      "    ${4:package4} \\",
      "    ${5:package5} \\",
      "    && rm -rf /var/lib/apt/lists/*"
    ],
    "description": "100万回使う apt-get構文"
  }
}
```

---

### 補足

- 「キャッシュ」と「レイヤー」を意識することがDockerfile最適化のカギ！
- 必要な場合に応じて、複数の形式を試してみてください！

---

